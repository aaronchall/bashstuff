echo $SP1
SP1="command prompt"
type # determine how shell finds command
file # classifies file based on content
date # displays date and time
alias # manage command shortcuts
unalias
sort # sorts contents of file (by line?)
uniq # print out unique lines in a sorted file
comm # print common line in pair of sorted files
ptx # produce permuted indexes
sleep # go to sleep for seconds
strings # display printable strings from a binary file
time # time a command

cat -v # flag shows viewable chars

cat foo bar | head -2
cat foo bar | tail -2

more # h gives help
less

# lpr mostly replaced by CUPS (which has web interface), but here's commands
lpr # print to default printer, can pipe and redirect into
lpr -MyPrinterName foofile
lpq # view print queue
lprm 14 # remove job 14
lpq -MyPrinterName
lpc # view print system stats

cut # cuts fields out of file, whitespace delimited default or other char with -d, 
tail /etc/passwd | cut -d: -f1,5 # f flag followed by list or range by dash for just those fields
cut -c1-3 # cut by char position, here chars 1,2,3 from the file

tr 'a-z' 'A-Z' < foo.file  # translate lower to upper
cat foofile | tr -dc 'aeiou\n' # -d will delete chars -dc will delete complements
wc foofile # word count of file, -l line count, -c char count, -w word count, default is all (-lwc)

grep word foofile # looks for "word" in file, returns line
grep -i word foofile # ignore case
grep '[aeiou]' foofile # look for lines with a vowel in them
grep 'a[^n]' foofile # look for lines with a not followed by n
grep 'a.*e' foofile # a must be followed by e with 0 or more other chars in between
grep 'a.a' foofile # two a's with any char between
grep '^a' foofile # a at beginning of line
grep 'a$' foofile # a at end of line, ^ and & lose this meaning at other places in regex

sort -r foofile # reverse sorts
sort -f foofile # ignore case (default is uppercases first)
sort foofile foofile2 # can sort more than one at a time
sort -t: -k2 foofile # using : as delimeter, sort by 2nd field, can numeric sort with -n
tsort # topological sort utility

cmp foofile1 foofile2 # compares files, reports if they differ (nothing if they don't)
cksum foofile1 foofile2

comm foofile1 foofile2 # if files are sorted, can search for common lines
comm -13 foofile1 foofile2 #suppress lines unique to file 1, suppresses lines in both files

diff -c foofile1 foofile2 # shows diff used in rcs and cvs for version control, -c more readable output, -u too
# zcomp, zdiff # utilities to compare compressed files

paste foofile foofile2 foofile3 # concatenate horizontally, joining with tabs
paste -s foofile # joins lines on a single line with tabs
paste -d ':\n' foofile # can control number of columns and delimiters (here, separate alternating by : then \n)

join -t= -12 foofile foofile2 # match fields delimited by = (tab default), here key field for file 1 is field 2
join -t= -12 -o 1.2 2.2 foofile foofile2 # -o flag can supply file.field pairs to output, instead of default 
# here join on second field, and output second field of each file.


multi-user!!!

mail foo@bar.com # enter subject, type message, ctrl-D or single period on lone line to stop, enter CC list
mail # with no commands, opens mailbox and presents list of messages, 
#can type number of message to view, d deletes, q quits

# Mutt is a client based on ELM with ideas from PINE and other freeware email clients
# POP3/IMAP services must be running in Linux for them to work on Outlook, e.g. in Windows shell:
telnet linux_machine_domain_name 143 # tests for IMAP server, exit with ". logout"
telnet linux_machine_domain_name 25 # show if mail server exists and is accessible, exit with "quit"
telnet linux_machine_domain_name 110 # tests for POP3 server, exit with "quit"
# if no response, possible firewall or no service

### Managing Processes ###

ps # show current status of process, no args just shows the ones belonging to the current login session
ps -f # show full information, including parent PID (PPID), starttime (STIME) and user id UID
ps -e # every process, can limit to users (-u) groups (-g) PIDs (-p) and terminal (-t)
ps -u user_a
ps -t tty4
ps -p 17075
ps -fp 17075
# two ways to manage processes: kill, skill and pkill or /proc interface
# signals: ctrl-c sends INT and ctrl-\ sends QUIT, HUP is a modem hangup, 
# kill can only send to own processes, unless superuser (root)
# sending to login shell kill -1 or kill -HUP will cause shell to terminate and log you out
kill # default is 15
kill <pid> # syntax
kill -9 <pid> # KILL
kill -1 <bash PID> # logout, i.e. HUP

# /proc entries
ls -l /proc/<pid>
tr '\0' '\r' < /proc/<pid>/environ # see the environment, translate ascii nulls to LF chars
ls -l /proc/<pid>/fd # file descriptor, see a processes open files (called file handle on some "other" systems)
umount /home # unmount the home file system, can't be done if a file process is open
ls -l /proc/*/fd | grep /home # find all files open in home filesystem

# end command with & to create running job in background
# ctrl-z to stop a running job
jobs # view jobs, '+' current job, '-' next to become current, status, command line used
fg # foreground the current job
^Z # ctrl-z to stop it
bg # background the job while running (like adding & to end)
fg %<n> # specify by job number, kill can use same specification, replacing the %n with the pid
# kill can also send SIGSTOP and SIGCONT

Scheduling
# cron, at, and batch to schedule tasks
# use cron for repetitive tasks
# crontab provides table of cron entries format is:
# min hr day mo dayofwk cmd
# create a new crontab,  
cat > mycron 
4 2 * * * /home/ajax/bin/mybackup
^D
crontab mycron
crontab -l # list the contents
crontab -r # remove the table
crontab -e # edit the table with editor named in editor or visual environment variables
# cron commands are run using the /bin/sh, standard Bourne shell
# output is typically captured and emailed to user, so common to redirect output, e.g.
3 5 * * 1-5 morning_job > /dev/null 2>&1
# shell env not the same as login env, may need to setup own environment including PATH
# at
at 10am tomorrow # schedule one-off job
at> /home/me/bin/reminder # prompt
at> <EOT> #  ctrl-d
# can use now + 3 days, times before current assumed to be tomorrow, days and months as names, 
# now tomorrow, noon, midnight, teatime (4pm) also understood
# batch
# batch is subset of at, defers processing until system load is light enough to continue
# batch waits until load average drops below .8 (busy system may have load average of 4.0+)
# simplest way to defer heavy job

# Logging
# syslog system is admin'd by system log daemon, syslogd
# amount and where controlled by /etc/syslog.conf, on RedHat is /var/log, others /var/adm
# syslog uses two params, facility and priority, syslog, 
# Facilities: http://en.wikipedia.org/wiki/Syslog#Facility_levels, additionally mark used internally
# priority levels of level mentioned and higher will be logged, can override with =
# don't overload system with log files, make sure utiltities like logrotate used to reduce impact of logging
# logs best defence against system instability, all subsystems capable of causing system failure write to logger
# logrotate rotates files to control size, may be requirement to send signal to syslogd or other process re new file
# generally 4 weeks of log files kept
# syslog entries have date, time, name of system, (maybe pid) then actual message
# syslog is network aware and may log to central host, 
# well-behaved applications use syslog facility or log directly to /var/log directory
# syslog writes more important message to /var/log/messages, security to /var/log/secure, mail to /var/log/maillog
# other facilities may use specific files in /var/log like cron, spooler, xferlog (ftp), and boot.log
# Apache stores log files in subdirectory of its installation dir, often linked to /var/log/httpd
# include access_log, error_log, and ssl_request_log, referring sites and CGI errors logs may also be configured
# Samba logs on /var/log/samba, 
# a file for each machine that uses files on the Linux system, 
# and for the two main components smbd (session establishment and control for file and printer sharing) 
#                             and nmbd (name to address mapping)
# many other apps that log, db servers, proxy servers, usenet news servers, know where ones on your system log
# general docs, including setup info, usually in /usr/doc, start with README and INSTALL

# Start with error messages in syslog when looking for why apps fail.
# system may create core file, containing memory image of process (main system memory was originally called core memory) 
# can be used to autopsy dead process
file core # do first to determine what program caused the core and what signal if any initiated core dump
man 7 signal # list signals
strings core | tail # strings displays printable strings from a binary file, 
# at end will be process environment including command used to start program
# can give clues to cause of death, looking for pathnames can give information about config files and shared libs
# System V (not always available)
system status # System V startup scheme frequently used for starting, stopping restarting, and getting status info
# files in /etc/rc.d/init.d or /etc/init.d are startup and shutdown files, 
# each takes single arg: start, stop, restart, status
/etc/rc.d/init.d/httpd status # give a short description fo status
/etc/rc.d/init.d/smb status 
# some apps also support reload and condrestart (conditional restart)

free # shows how much free system memory there is
top # displays process information and system wide information in tabular form

# review man pages for syslog, logger, and chkconfig (for System V), see tldp.org












 

















